/* Color.c generated by valac 0.48.17, the Vala compiler
 * generated from Color.vala, do not modify */

/*
* Copyright (c) 2011-2020 LightPad
*
* This program is free software; you can redistribute it and/or
* modify it under the terms of the GNU General Public
* License as published by the Free Software Foundation; either
* version 2 of the License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
* General Public License for more details.
*
* You should have received a copy of the GNU General Public
* License along with this program; if not, write to the
* Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
* Boston, MA 02110-1301 USA
*
* Authored by: Juan Pablo Lozano <libredeb@gmail.com>
*/

#include <glib-object.h>
#include <glib.h>
#include <float.h>
#include <math.h>
#include <string.h>

#define LIGHT_PAD_FRONTEND_TYPE_COLOR (light_pad_frontend_color_get_type ())
typedef struct _LightPadFrontendColor LightPadFrontendColor;
#define _vala_assert(expr, msg) if G_LIKELY (expr) ; else g_assertion_message_expr (G_LOG_DOMAIN, __FILE__, __LINE__, G_STRFUNC, msg);
#define _vala_return_if_fail(expr, msg) if G_LIKELY (expr) ; else { g_return_if_fail_warning (G_LOG_DOMAIN, G_STRFUNC, msg); return; }
#define _vala_return_val_if_fail(expr, msg, val) if G_LIKELY (expr) ; else { g_return_if_fail_warning (G_LOG_DOMAIN, G_STRFUNC, msg); return val; }
#define _vala_warn_if_fail(expr, msg) if G_LIKELY (expr) ; else g_warn_message (G_LOG_DOMAIN, __FILE__, __LINE__, G_STRFUNC, msg);

struct _LightPadFrontendColor {
	gdouble R;
	gdouble G;
	gdouble B;
	gdouble A;
};

GType light_pad_frontend_color_get_type (void) G_GNUC_CONST;
LightPadFrontendColor* light_pad_frontend_color_dup (const LightPadFrontendColor* self);
void light_pad_frontend_color_free (LightPadFrontendColor* self);
void light_pad_frontend_color_init (LightPadFrontendColor *self,
                                    gdouble R,
                                    gdouble G,
                                    gdouble B,
                                    gdouble A);
void light_pad_frontend_color_set_val (LightPadFrontendColor *self,
                                       gdouble val,
                                       LightPadFrontendColor* result);
static void light_pad_frontend_color_rgb_to_hsv (LightPadFrontendColor *self,
                                          gdouble r,
                                          gdouble g,
                                          gdouble b,
                                          gdouble* h,
                                          gdouble* s,
                                          gdouble* v);
static void light_pad_frontend_color_hsv_to_rgb (LightPadFrontendColor *self,
                                          gdouble h,
                                          gdouble s,
                                          gdouble v,
                                          gdouble* r,
                                          gdouble* g,
                                          gdouble* b);
void light_pad_frontend_color_multiply_sat (LightPadFrontendColor *self,
                                            gdouble amount,
                                            LightPadFrontendColor* result);

void
light_pad_frontend_color_init (LightPadFrontendColor *self,
                               gdouble R,
                               gdouble G,
                               gdouble B,
                               gdouble A)
{
#line 32 "../docklets/Lightpad/Color.vala"
	memset (self, 0, sizeof (LightPadFrontendColor));
#line 33 "../docklets/Lightpad/Color.vala"
	(*self).R = R;
#line 34 "../docklets/Lightpad/Color.vala"
	(*self).G = G;
#line 35 "../docklets/Lightpad/Color.vala"
	(*self).B = B;
#line 36 "../docklets/Lightpad/Color.vala"
	(*self).A = A;
#line 92 "Color.c"
}

void
light_pad_frontend_color_set_val (LightPadFrontendColor *self,
                                  gdouble val,
                                  LightPadFrontendColor* result)
{
	gdouble h = 0.0;
	gdouble s = 0.0;
	gdouble v = 0.0;
	gdouble _tmp0_ = 0.0;
	gdouble _tmp1_ = 0.0;
	gdouble _tmp2_ = 0.0;
	gdouble _tmp3_ = 0.0;
	gdouble _tmp4_ = 0.0;
	gdouble _tmp5_ = 0.0;
#line 39 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((val >= ((gdouble) 0)) && (val <= ((gdouble) 1)), "val >= 0 && val <= 1");
#line 41 "../docklets/Lightpad/Color.vala"
	light_pad_frontend_color_rgb_to_hsv (&(*self), (*self).R, (*self).G, (*self).B, &_tmp0_, &_tmp1_, &_tmp2_);
#line 41 "../docklets/Lightpad/Color.vala"
	h = _tmp0_;
#line 41 "../docklets/Lightpad/Color.vala"
	s = _tmp1_;
#line 41 "../docklets/Lightpad/Color.vala"
	v = _tmp2_;
#line 42 "../docklets/Lightpad/Color.vala"
	v = val;
#line 43 "../docklets/Lightpad/Color.vala"
	light_pad_frontend_color_hsv_to_rgb (&(*self), h, s, v, &_tmp3_, &_tmp4_, &_tmp5_);
#line 43 "../docklets/Lightpad/Color.vala"
	(*self).R = _tmp3_;
#line 43 "../docklets/Lightpad/Color.vala"
	(*self).G = _tmp4_;
#line 43 "../docklets/Lightpad/Color.vala"
	(*self).B = _tmp5_;
#line 45 "../docklets/Lightpad/Color.vala"
	*result = (*self);
#line 45 "../docklets/Lightpad/Color.vala"
	return;
#line 133 "Color.c"
}

void
light_pad_frontend_color_multiply_sat (LightPadFrontendColor *self,
                                       gdouble amount,
                                       LightPadFrontendColor* result)
{
	gdouble h = 0.0;
	gdouble s = 0.0;
	gdouble v = 0.0;
	gdouble _tmp0_ = 0.0;
	gdouble _tmp1_ = 0.0;
	gdouble _tmp2_ = 0.0;
	gdouble _tmp3_ = 0.0;
	gdouble _tmp4_ = 0.0;
	gdouble _tmp5_ = 0.0;
#line 48 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail (amount >= ((gdouble) 0), "amount >= 0");
#line 50 "../docklets/Lightpad/Color.vala"
	light_pad_frontend_color_rgb_to_hsv (&(*self), (*self).R, (*self).G, (*self).B, &_tmp0_, &_tmp1_, &_tmp2_);
#line 50 "../docklets/Lightpad/Color.vala"
	h = _tmp0_;
#line 50 "../docklets/Lightpad/Color.vala"
	s = _tmp1_;
#line 50 "../docklets/Lightpad/Color.vala"
	v = _tmp2_;
#line 51 "../docklets/Lightpad/Color.vala"
	s = fmin ((gdouble) 1, s * amount);
#line 52 "../docklets/Lightpad/Color.vala"
	light_pad_frontend_color_hsv_to_rgb (&(*self), h, s, v, &_tmp3_, &_tmp4_, &_tmp5_);
#line 52 "../docklets/Lightpad/Color.vala"
	(*self).R = _tmp3_;
#line 52 "../docklets/Lightpad/Color.vala"
	(*self).G = _tmp4_;
#line 52 "../docklets/Lightpad/Color.vala"
	(*self).B = _tmp5_;
#line 54 "../docklets/Lightpad/Color.vala"
	*result = (*self);
#line 54 "../docklets/Lightpad/Color.vala"
	return;
#line 174 "Color.c"
}

static void
light_pad_frontend_color_rgb_to_hsv (LightPadFrontendColor *self,
                                     gdouble r,
                                     gdouble g,
                                     gdouble b,
                                     gdouble* h,
                                     gdouble* s,
                                     gdouble* v)
{
	gdouble _vala_h = 0.0;
	gdouble _vala_s = 0.0;
	gdouble _vala_v = 0.0;
	gdouble min = 0.0;
	gdouble max = 0.0;
	gdouble delta = 0.0;
#line 57 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((r >= ((gdouble) 0)) && (r <= ((gdouble) 1)), "r >= 0 && r <= 1");
#line 57 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((g >= ((gdouble) 0)) && (g <= ((gdouble) 1)), "g >= 0 && g <= 1");
#line 57 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((b >= ((gdouble) 0)) && (b <= ((gdouble) 1)), "b >= 0 && b <= 1");
#line 62 "../docklets/Lightpad/Color.vala"
	min = fmin (r, fmin (g, b));
#line 63 "../docklets/Lightpad/Color.vala"
	max = fmax (r, fmax (g, b));
#line 65 "../docklets/Lightpad/Color.vala"
	_vala_v = max;
#line 66 "../docklets/Lightpad/Color.vala"
	if (_vala_v == ((gdouble) 0)) {
#line 67 "../docklets/Lightpad/Color.vala"
		_vala_h = (gdouble) 0;
#line 68 "../docklets/Lightpad/Color.vala"
		_vala_s = (gdouble) 0;
#line 69 "../docklets/Lightpad/Color.vala"
		if (h) {
#line 69 "../docklets/Lightpad/Color.vala"
			*h = _vala_h;
#line 214 "Color.c"
		}
#line 69 "../docklets/Lightpad/Color.vala"
		if (s) {
#line 69 "../docklets/Lightpad/Color.vala"
			*s = _vala_s;
#line 220 "Color.c"
		}
#line 69 "../docklets/Lightpad/Color.vala"
		if (v) {
#line 69 "../docklets/Lightpad/Color.vala"
			*v = _vala_v;
#line 226 "Color.c"
		}
#line 69 "../docklets/Lightpad/Color.vala"
		return;
#line 230 "Color.c"
	}
#line 73 "../docklets/Lightpad/Color.vala"
	r = r / _vala_v;
#line 74 "../docklets/Lightpad/Color.vala"
	g = g / _vala_v;
#line 75 "../docklets/Lightpad/Color.vala"
	b = b / _vala_v;
#line 77 "../docklets/Lightpad/Color.vala"
	min = fmin (r, fmin (g, b));
#line 78 "../docklets/Lightpad/Color.vala"
	max = fmax (r, fmax (g, b));
#line 80 "../docklets/Lightpad/Color.vala"
	delta = max - min;
#line 81 "../docklets/Lightpad/Color.vala"
	_vala_s = delta;
#line 82 "../docklets/Lightpad/Color.vala"
	if (_vala_s == ((gdouble) 0)) {
#line 83 "../docklets/Lightpad/Color.vala"
		_vala_h = (gdouble) 0;
#line 84 "../docklets/Lightpad/Color.vala"
		if (h) {
#line 84 "../docklets/Lightpad/Color.vala"
			*h = _vala_h;
#line 254 "Color.c"
		}
#line 84 "../docklets/Lightpad/Color.vala"
		if (s) {
#line 84 "../docklets/Lightpad/Color.vala"
			*s = _vala_s;
#line 260 "Color.c"
		}
#line 84 "../docklets/Lightpad/Color.vala"
		if (v) {
#line 84 "../docklets/Lightpad/Color.vala"
			*v = _vala_v;
#line 266 "Color.c"
		}
#line 84 "../docklets/Lightpad/Color.vala"
		return;
#line 270 "Color.c"
	}
#line 88 "../docklets/Lightpad/Color.vala"
	r = (r - min) / delta;
#line 89 "../docklets/Lightpad/Color.vala"
	g = (g - min) / delta;
#line 90 "../docklets/Lightpad/Color.vala"
	b = (b - min) / delta;
#line 92 "../docklets/Lightpad/Color.vala"
	if (max == r) {
#line 93 "../docklets/Lightpad/Color.vala"
		_vala_h = 0 + (60 * (g - b));
#line 94 "../docklets/Lightpad/Color.vala"
		if (_vala_h < ((gdouble) 0)) {
#line 95 "../docklets/Lightpad/Color.vala"
			_vala_h = _vala_h + 360;
#line 286 "Color.c"
		}
	} else {
#line 97 "../docklets/Lightpad/Color.vala"
		if (max == g) {
#line 98 "../docklets/Lightpad/Color.vala"
			_vala_h = 120 + (60 * (b - r));
#line 293 "Color.c"
		} else {
#line 100 "../docklets/Lightpad/Color.vala"
			_vala_h = 240 + (60 * (r - g));
#line 297 "Color.c"
		}
	}
#line 57 "../docklets/Lightpad/Color.vala"
	if (h) {
#line 57 "../docklets/Lightpad/Color.vala"
		*h = _vala_h;
#line 304 "Color.c"
	}
#line 57 "../docklets/Lightpad/Color.vala"
	if (s) {
#line 57 "../docklets/Lightpad/Color.vala"
		*s = _vala_s;
#line 310 "Color.c"
	}
#line 57 "../docklets/Lightpad/Color.vala"
	if (v) {
#line 57 "../docklets/Lightpad/Color.vala"
		*v = _vala_v;
#line 316 "Color.c"
	}
}

static void
light_pad_frontend_color_hsv_to_rgb (LightPadFrontendColor *self,
                                     gdouble h,
                                     gdouble s,
                                     gdouble v,
                                     gdouble* r,
                                     gdouble* g,
                                     gdouble* b)
{
	gdouble _vala_r = 0.0;
	gdouble _vala_g = 0.0;
	gdouble _vala_b = 0.0;
#line 104 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((h >= ((gdouble) 0)) && (h <= ((gdouble) 360)), "h >= 0 && h <= 360");
#line 104 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((s >= ((gdouble) 0)) && (s <= ((gdouble) 1)), "s >= 0 && s <= 1");
#line 104 "../docklets/Lightpad/Color.vala"
	_vala_return_if_fail ((v >= ((gdouble) 0)) && (v <= ((gdouble) 1)), "v >= 0 && v <= 1");
#line 109 "../docklets/Lightpad/Color.vala"
	_vala_r = (gdouble) 0;
#line 110 "../docklets/Lightpad/Color.vala"
	_vala_g = (gdouble) 0;
#line 111 "../docklets/Lightpad/Color.vala"
	_vala_b = (gdouble) 0;
#line 113 "../docklets/Lightpad/Color.vala"
	if (s == ((gdouble) 0)) {
#line 114 "../docklets/Lightpad/Color.vala"
		_vala_r = v;
#line 115 "../docklets/Lightpad/Color.vala"
		_vala_g = v;
#line 116 "../docklets/Lightpad/Color.vala"
		_vala_b = v;
#line 352 "Color.c"
	} else {
		gint secNum = 0;
		gdouble fracSec = 0.0;
		gdouble p = 0.0;
		gdouble q = 0.0;
		gdouble t = 0.0;
#line 122 "../docklets/Lightpad/Color.vala"
		secNum = (gint) floor (h / 60);
#line 123 "../docklets/Lightpad/Color.vala"
		fracSec = (h / 60) - secNum;
#line 125 "../docklets/Lightpad/Color.vala"
		p = v * (1 - s);
#line 126 "../docklets/Lightpad/Color.vala"
		q = v * (1 - (s * fracSec));
#line 127 "../docklets/Lightpad/Color.vala"
		t = v * (1 - (s * (1 - fracSec)));
#line 129 "../docklets/Lightpad/Color.vala"
		switch (secNum) {
#line 129 "../docklets/Lightpad/Color.vala"
			case 0:
#line 373 "Color.c"
			{
#line 131 "../docklets/Lightpad/Color.vala"
				_vala_r = v;
#line 132 "../docklets/Lightpad/Color.vala"
				_vala_g = t;
#line 133 "../docklets/Lightpad/Color.vala"
				_vala_b = p;
#line 134 "../docklets/Lightpad/Color.vala"
				break;
#line 383 "Color.c"
			}
#line 129 "../docklets/Lightpad/Color.vala"
			case 1:
#line 387 "Color.c"
			{
#line 136 "../docklets/Lightpad/Color.vala"
				_vala_r = q;
#line 137 "../docklets/Lightpad/Color.vala"
				_vala_g = v;
#line 138 "../docklets/Lightpad/Color.vala"
				_vala_b = p;
#line 139 "../docklets/Lightpad/Color.vala"
				break;
#line 397 "Color.c"
			}
#line 129 "../docklets/Lightpad/Color.vala"
			case 2:
#line 401 "Color.c"
			{
#line 141 "../docklets/Lightpad/Color.vala"
				_vala_r = p;
#line 142 "../docklets/Lightpad/Color.vala"
				_vala_g = v;
#line 143 "../docklets/Lightpad/Color.vala"
				_vala_b = t;
#line 144 "../docklets/Lightpad/Color.vala"
				break;
#line 411 "Color.c"
			}
#line 129 "../docklets/Lightpad/Color.vala"
			case 3:
#line 415 "Color.c"
			{
#line 146 "../docklets/Lightpad/Color.vala"
				_vala_r = p;
#line 147 "../docklets/Lightpad/Color.vala"
				_vala_g = q;
#line 148 "../docklets/Lightpad/Color.vala"
				_vala_b = v;
#line 149 "../docklets/Lightpad/Color.vala"
				break;
#line 425 "Color.c"
			}
#line 129 "../docklets/Lightpad/Color.vala"
			case 4:
#line 429 "Color.c"
			{
#line 151 "../docklets/Lightpad/Color.vala"
				_vala_r = t;
#line 152 "../docklets/Lightpad/Color.vala"
				_vala_g = p;
#line 153 "../docklets/Lightpad/Color.vala"
				_vala_b = v;
#line 154 "../docklets/Lightpad/Color.vala"
				break;
#line 439 "Color.c"
			}
#line 129 "../docklets/Lightpad/Color.vala"
			case 5:
#line 443 "Color.c"
			{
#line 156 "../docklets/Lightpad/Color.vala"
				_vala_r = v;
#line 157 "../docklets/Lightpad/Color.vala"
				_vala_g = p;
#line 158 "../docklets/Lightpad/Color.vala"
				_vala_b = q;
#line 159 "../docklets/Lightpad/Color.vala"
				break;
#line 453 "Color.c"
			}
			default:
#line 129 "../docklets/Lightpad/Color.vala"
			break;
#line 458 "Color.c"
		}
	}
#line 104 "../docklets/Lightpad/Color.vala"
	if (r) {
#line 104 "../docklets/Lightpad/Color.vala"
		*r = _vala_r;
#line 465 "Color.c"
	}
#line 104 "../docklets/Lightpad/Color.vala"
	if (g) {
#line 104 "../docklets/Lightpad/Color.vala"
		*g = _vala_g;
#line 471 "Color.c"
	}
#line 104 "../docklets/Lightpad/Color.vala"
	if (b) {
#line 104 "../docklets/Lightpad/Color.vala"
		*b = _vala_b;
#line 477 "Color.c"
	}
}

LightPadFrontendColor*
light_pad_frontend_color_dup (const LightPadFrontendColor* self)
{
	LightPadFrontendColor* dup;
#line 26 "../docklets/Lightpad/Color.vala"
	dup = g_new0 (LightPadFrontendColor, 1);
#line 26 "../docklets/Lightpad/Color.vala"
	memcpy (dup, self, sizeof (LightPadFrontendColor));
#line 26 "../docklets/Lightpad/Color.vala"
	return dup;
#line 491 "Color.c"
}

void
light_pad_frontend_color_free (LightPadFrontendColor* self)
{
#line 26 "../docklets/Lightpad/Color.vala"
	g_free (self);
#line 499 "Color.c"
}

static GType
light_pad_frontend_color_get_type_once (void)
{
	GType light_pad_frontend_color_type_id;
	light_pad_frontend_color_type_id = g_boxed_type_register_static ("LightPadFrontendColor", (GBoxedCopyFunc) light_pad_frontend_color_dup, (GBoxedFreeFunc) light_pad_frontend_color_free);
	return light_pad_frontend_color_type_id;
}

GType
light_pad_frontend_color_get_type (void)
{
	static volatile gsize light_pad_frontend_color_type_id__volatile = 0;
	if (g_once_init_enter (&light_pad_frontend_color_type_id__volatile)) {
		GType light_pad_frontend_color_type_id;
		light_pad_frontend_color_type_id = light_pad_frontend_color_get_type_once ();
		g_once_init_leave (&light_pad_frontend_color_type_id__volatile, light_pad_frontend_color_type_id);
	}
	return light_pad_frontend_color_type_id__volatile;
}

